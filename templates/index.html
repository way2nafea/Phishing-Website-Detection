<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phishing Website Detection Tool | URL Safety Checker</title>

  <meta name="description" content="Check if a website URL is safe or phishing using machine learning, Google Safe Browsing, and SSL analysis.">
  <meta name="keywords" content="phishing checker, url safety, website security, phishing detection">
  <meta name="author" content="Team Apex">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="container">

  <header class="header">
    <h1 class="logo-title">Website Phishing Detection</h1>
    
    <div class="user-info">
      <span>{{ current_user.username }}</span>
      <a href="{{ url_for('dashboard') }}" class="dashboard-link">Dashboard</a>
      <a href="{{ url_for('logout') }}" class="logout-link">Logout</a>
    </div>
  </header>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="result-box {% if category == 'success' %}safe-box{% else %}danger-box{% endif %}" style="margin-bottom: 20px;">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <main class="scan-box">
    <form action="/" method="post" id="scanForm">
      
      <input type="text"
             class="form-control"
             name="url"
             placeholder="Paste URL to analyze..."
             required>

      <button type="submit" class="btn-success">
        Analyze URL
      </button>

      <div id="loading" class="result-box warning-box" style="display:none; justify-content: center; border-style: dashed;">
        <span>Analyzing security layers...</span>
      </div>

    </form>
  </main>

  {% if url and prediction %}
  <section class="results">
    <div style="margin-top: 30px; border-top: 1px solid var(--border-color); padding-top: 20px;">
      <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 5px;">TARGET URL</p>
      <p style="word-break: break-all; font-weight: 600; font-size: 0.9rem;">{{ url }}</p>

      {% if risk_score is defined %}
      <div style="margin-top: 20px;">
        <div style="display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 8px;">
          <span>Risk Probability</span>
          <span style="font-weight: bold; color: var(--brand-color);">{{ risk_score|round(1) }}%</span>
        </div>
        
        <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden;">
          <div style="width: {{ risk_score }}%; height: 100%; background: {% if risk_score < 30 %}var(--brand-color){% elif risk_score < 70 %}var(--warning-color){% else %}var(--danger-color){% endif %}; transition: width 1s ease-in-out;"></div>
        </div>
      </div>
      {% endif %}

      {% if xx == 1 %}
        <div class="result-box safe-box">
          <strong>‚úÖ Safe:</strong> {{ prediction }}
        </div>
      {% elif xx == 0 %}
        <div class="result-box warning-box">
          <strong>‚ö†Ô∏è Suspicious:</strong> {{ prediction }}
        </div>
      {% elif xx == -1 %}
        <div class="result-box danger-box">
          <strong>üö´ Phishing:</strong> {{ prediction }}
        </div>
      {% endif %}
    </div>
  </section>
  {% endif %}

  <footer class="footer">
    <p>¬© 2026 Team Apex</p>
  </footer>

</div>

<script>
  // Simple logic to show loading state
  document.getElementById("scanForm").addEventListener("submit", function () {
      const btn = this.querySelector('.btn-success');
      btn.style.opacity = "0.7";
      btn.innerText = "Scanning...";
      document.getElementById("loading").style.display = "flex";
  });
</script>

</body>
</html>